# Bain challenge


## Endpoint usage

## Local testing
```
docker build --build-arg MODEL_VERSION=0.1.0 -t ml-milk-app -f app/Dockerfile .
docker run -d -p 80:80 --name milk-api ml-milk-app
```
```
curl -X POST "http://127.0.0.1:5000/v1/milk_price/predict" -H\
 "accept: application/json"\
 -H "Content-Type: application/json"\
 -d "{\"data\":[[2.01400000e+03,2.19030000e+02,2.00000000e+00,1.68885621e+00,8.38985390e+00,1.78030705e+01,7.29517830e+00,3.01593178e+00, \
 2.21861968e+01,4.31574106e+01,6.52280104e+01,5.89162366e+08,5.30628153e+08,1.18979099e+08,1.07686125e+08,1.12929737e+08,\
 1.17324454e+08,3.26848287e+08,1.51002582e+08,2.47771010e+07,5.84892910e+07,9.85263519e+08,9.87746023e+08,1.69050011e+08,\
 6.37721806e+08,1.82004135e+08,2.76725914e+08,6.21419201e+08,1.06567859e+08,2.15199970e+07,5.30525285e+08,3.29424874e+08,\
 6.02969763e+08,1.16462931e+08,8.29465384e+08,6.90060504e+08,5.23184092e+08,9.85454361e+08,1.07497828e+08,9.35000000e+01,\
 9.82000000e+01,9.42000000e+01,9.18000000e+01,1.07454000e+02,1.02175000e+02,8.88000000e+01,9.37100000e+01,9.34000000e+01,\
 9.28000000e+01]]}"
```
## Decisions

- Given that data is loaded from a local file is implemented in the same function that does preprocess logic.
- The api was developed with FastAPI
- In this project all the requirements are mixed but is possible split them for preprocessing, model and evaluation.
- The coverage was not addressed with priority.
- Logging is implemented with priority in order to check info, errors and debugging.
- There are two docker files:
  - Dockerfile: this one correspond to FastAPI image
  - Dockerfile.pipeline: this image is generated to run the generated pipeline in a docker container in interactive mode
- The code is not directly decorated with task for prefect, in this way is easier migrate from prefect framework to another one if necessary. 
- The tasks are just functions wrappers with prefect logging included. 

## Observations

- After running jupyter notebook locally the shape of "precio_leche_pp_pib" dataframe changed from (90, 49) to (76, 49) this shape is equivalent to the generated by pipeline during ETL process.
- 

## Future work

- Optimize hyperparameter search